<% const navigationContent = include('./partials/drive/navigation.ejs', { navigation: { 
                    selectedLayout: layout ?? 'grid',
                    features: features ?? {
                        showSearch: false,
                        showCreateFolder: false,
                        showUploadFile: false,
                        showShareFolder: false,
                    },
                    actions: actions,
                    urls: urls,
                    sharedFolderOwner: locals.sharedFolderOwner ?? null,
                    isSharedFolder: !!locals.sharedFolder,
                    currentFoldername: locals.currentFolder ? locals.currentFolder.name : '',
                    parentFolderName: locals.currentFolder ? locals.currentFolder.parentFolder ? currentFolder.parentFolder.name : '' : '',
                    isParentPartOfRoot: locals.sharedFolder ? false : locals.currentFolder ? rootFolders.some(f => f.id === currentFolder.parentFolderId) : undefined,
                    hasBreadcrumbsNavigation: true
 } }); %>
<% const layoutContent = layout === 'grid'
     ? include('./layouts/drive/grid.ejs', { 
                    grid: {
                        enableActions: features.showOptions ,
                        files: locals.currentFolder ? locals.currentFolder.files : [] ,
                        folders: locals.currentFolder ? currentFolder.folders : [],
                        sharedFolder: locals.sharedFolder,
                        folders: locals.currentFolder?.subfolders ?? rootFolders,
                        canGoBack: features.canGoBack,
                        goBackLink: urls.parentFolderLink
                    }
 })
     : include('./layouts/drive/list-view.ejs', { listView: { 
                        enableActions: features.showOptions ,
                        files: locals.currentFolder ? locals.currentFolder.files : [] ,
                        folders: locals.currentFolder ? currentFolder.folders : [],
                        sharedFolder: locals.sharedFolder,
                        folders: locals.currentFolder?.subfolders ?? rootFolders,
                        canGoBack: features.canGoBack,
                        goBackLink: urls.parentFolderLink
 } }); %>

<%- include('./layouts/drive-base.ejs', {
    alerts: locals.alerts,
    sidebar: 
        include('./partials/drive/sidebar.ejs', {
            sidebar: {
                features,
                actions,
                sharedFolder: locals.sharedFolder,
                currentUser,
                rootFolders,
            }
        }),
    mainContent: navigationContent + layoutContent,
    dialog: locals.createdSharedFolderLink && 
        include('./components/dialog.ejs', {
            dialog:{
            id: 'link-created-dialog',
            title: 'Link created',
            isOpen: true,
            content: include('./partials/drive/copy-folder-link.ejs', {createdSharedFolderLink}),
            showCloseButton: true,
            }
        }) 
}) %>